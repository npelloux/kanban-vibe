# [M2-D2.3] Implement redo action with keyboard shortcut

## Deliverable: Users can redo undone actions via Ctrl+Shift+Z or toolbar button

### Context
**PRD:** `docs/project/PRD/active/PRD-phase2-enhanced-ux.md` — M2: Undo/Redo System, D2.3

After undoing actions, users may want to re-apply them. This deliverable adds keyboard shortcut (Ctrl+Shift+Z / Cmd+Shift+Z) and toolbar button to restore undone state.

### Traceability
- **PRD Section:** M2-D2.3 "Redo action"
- **Functional Requirement:** Keyboard shortcut Ctrl+Shift+Z/Cmd+Shift+Z, toolbar button, re-applies undone state
- **Success Criteria:** SC-2 "Redo re-applies undone action"

### Acceptance Criteria
- [ ] Ctrl+Shift+Z (Windows/Linux) triggers redo
- [ ] Cmd+Shift+Z (macOS) triggers redo
- [ ] Ctrl+Y (Windows alternative) triggers redo
- [ ] Redo button appears in navigation bar next to undo button
- [ ] Redo button disabled when canRedo() is false
- [ ] Redo restores the state that was undone
- [ ] Multiple consecutive redos move forward through history
- [ ] New action after undo clears redo history

### Edge Case Scenarios
- Press Ctrl+Shift+Z with no redo history → No action, button remains disabled
- Press Ctrl+Shift+Z at end of history → No action, state unchanged
- Undo then perform new action then redo → Redo disabled (forward history cleared)
- Redo during policy execution → Policy cancelled, then redo applied
- Press Ctrl+Shift+Z while input field focused → No app redo (skip)

### Implementation Guidelines
- Extend keyboard event listener in `src/App.tsx` to handle Shift modifier
- Handle both Ctrl+Shift+Z and Ctrl+Y for Windows compatibility
- Add redo button to `src/components/NavigationBar.tsx` next to undo button
- Use SVG icon for redo (clockwise arrow)
- Integrate with history manager: call `historyManager.redo()`
- Apply returned state to all app state setters
- Ensure undo and redo buttons visually grouped in nav bar

### Embedded Reasoning
**Why:** Redo completes the undo functionality—users may undo too far and need to restore actions.
**What:** Redo functionality triggered by Ctrl+Shift+Z or clicking redo button, restoring undone state.
**How:** Extend keyboard listener to detect shift modifier, add paired button, call history manager's redo method.

### Testing Strategy
- **Unit:** Test keyboard listener responds to Ctrl+Shift+Z
- **Unit:** Test keyboard listener responds to Cmd+Shift+Z (metaKey + shiftKey)
- **Unit:** Test keyboard listener responds to Ctrl+Y
- **Unit:** Test redo button disabled state matches canRedo()
- **Unit:** Test redo button click calls redo function
- **Integration:** Test undo then redo restores original state
- **Integration:** Test new action clears redo history
- **Edge Cases:** Test no-op at history end, test input field focus bypass

### Dependencies
Depends on M2-D2.1 (State history manager), M2-D2.2 (Undo action)

### Verification
1. Add card, undo, press Ctrl+Shift+Z → Card reappears
2. Undo 3 times, redo 2 times → State matches 2nd-to-last action
3. Undo, add new card, check redo button → Redo disabled
4. Click redo button with no redo history → Button disabled, no action
5. Run `npm test` → All redo tests pass
