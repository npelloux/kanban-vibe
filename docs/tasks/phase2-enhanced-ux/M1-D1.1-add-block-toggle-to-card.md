# [M1-D1.1] Add block toggle to card component

## Deliverable: Users can block/unblock any card via UI click with visual feedback

### Context
**PRD:** `docs/project/PRD/active/PRD-phase2-enhanced-ux.md` — M1: Card Blocking UI, D1.1

Users currently cannot mark cards as blocked without editing code. This deliverable adds a visual toggle button on each card that allows users to block/unblock cards during simulation, enabling experimentation with blocked work scenarios without code changes.

### Traceability
- **PRD Section:** M1-D1.1 "Add block toggle to card component"
- **Functional Requirement:** Visual toggle button (lock/unlock icon) on each card
- **Success Criteria:** SC-1 "Users can block/unblock cards via UI click"

### Acceptance Criteria
- [ ] Lock icon displays on card header when blocked
- [ ] Unlock icon displays on card header when not blocked
- [ ] Clicking the icon toggles the `isBlocked` state
- [ ] Blocked cards display red border (existing `.card-blocked` class)
- [ ] Blocked cards show "BLOCKED!" badge (existing behavior)
- [ ] Toggle works in all column stages (options through done)
- [ ] Click on toggle does not trigger card click/move behavior

### Edge Case Scenarios
- Click toggle rapidly multiple times → State toggles correctly without race conditions
- Toggle card that is mid-drag-over → Drag state and block state remain independent
- Toggle card with assigned workers → Workers remain assigned, card becomes blocked
- Toggle blocked card during policy execution → Policy respects blocked state on next iteration

### Implementation Guidelines
- Modify `src/components/Card.tsx` to add toggle button in card header
- Use existing `isBlocked` prop which is already passed to Card component
- Add new `onToggleBlock?: (cardId: string) => void` prop to Card component
- Toggle button should use `e.stopPropagation()` to prevent triggering card click
- Follow existing pattern for click handlers in Card component (see `onClick` prop usage)
- Reuse existing `.card-blocked` CSS class for visual styling
- Button styling should match existing card UI (see `src/App.css` for card styles)

### Embedded Reasoning
**Why:** Users need to experiment with blocked work scenarios to understand flow impacts, but currently this requires code changes, breaking the "safe experimentation" principle.
**What:** A toggle button on each card that switches the `isBlocked` state with immediate visual feedback.
**How:** Add a clickable icon in the card header that calls a new `onToggleBlock` callback, with event propagation stopped to prevent card movement.

### Testing Strategy
- **Unit:** Test Card component renders correct icon based on `isBlocked` prop
- **Unit:** Test toggle click calls `onToggleBlock` with correct card ID
- **Unit:** Test toggle click does not trigger `onClick` handler
- **Integration:** Test toggling block state updates card appearance in real-time
- **Edge Cases:** Test rapid clicking, test during drag operations

### Dependencies
None - this is a foundational feature for Phase 2

### Verification
1. Click unlock icon on any unblocked card → Card shows locked icon, red border, "BLOCKED!" badge
2. Click lock icon on blocked card → Card shows unlock icon, normal styling
3. Run `npm test` → All Card component tests pass
4. Manual test: Click toggle during policy run → Card respects blocked state
