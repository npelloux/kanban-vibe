# [M4-D4.3] Add clear saved data option with confirmation

## Deliverable: Button to reset simulation to fresh state with confirmation dialog

### Context
**PRD:** `docs/project/PRD/active/PRD-phase2-enhanced-ux.md` — M4: Auto-Save with localStorage, D4.3

With auto-save enabled, users need a way to intentionally start fresh. This deliverable adds a "Reset" button with confirmation to clear saved data and return to the initial empty state.

### Traceability
- **PRD Section:** M4-D4.3 "Clear saved data option"
- **Functional Requirement:** Button to reset to fresh state, confirmation dialog before clearing
- **Success Criteria:** SC-4 "Users can start fresh"

### Acceptance Criteria
- [ ] "Reset Simulation" button in navigation bar (near save/import actions)
- [ ] Clicking button shows confirmation dialog
- [ ] Confirmation text: "Are you sure? This will clear all cards, reset the day counter, and cannot be undone."
- [ ] "Cancel" button closes dialog, no action
- [ ] "Reset" button clears localStorage and resets app state
- [ ] After reset: day=0, cards=[], workers=initial, wipLimits=defaults, historicalData=[]
- [ ] Success toast after reset: "Simulation reset to initial state"

### Edge Case Scenarios
- Click Reset with unsaved changes → Confirmation shows, changes lost if confirmed
- Click Reset then Cancel → No changes, state preserved
- Click Reset during policy execution → Policy cancelled, then reset proceeds
- Reset with undo history → History cleared (cannot undo a reset)
- localStorage already empty → Reset still works, shows confirmation

### Implementation Guidelines
- Add reset button to `src/components/NavigationBar.tsx` dropdown menu
- Create `src/components/ConfirmDialog.tsx` reusable component:
```typescript
interface ConfirmDialogProps {
  isOpen: boolean;
  title: string;
  message: string;
  confirmLabel?: string;  // default: "Confirm"
  cancelLabel?: string;   // default: "Cancel"
  onConfirm: () => void;
  onCancel: () => void;
  variant?: 'danger' | 'warning' | 'info';  // affects button color
}
```
- Use `variant='danger'` for reset confirmation (red confirm button)
- Reset function in `src/App.tsx`:
```typescript
const handleReset = () => {
  localStorage.removeItem('kanban-vibe-autosave');
  setCurrentDay(0);
  setCards([]);
  setWorkers(initialWorkers);
  setWipLimits(initialWipLimits);
  setHistoricalData([]);
  // Clear undo history
  historyManager.clear();
  addToast({ type: 'success', message: 'Simulation reset to initial state' });
};
```
- Dialog should be modal (blocks interaction with rest of app)
- ESC key closes dialog (cancel action)

### Embedded Reasoning
**Why:** Users need escape hatch from auto-save—ability to start fresh for new experiments or demonstrations.
**What:** Reset button with confirmation dialog that clears all state and localStorage.
**How:** Reusable confirmation dialog component, reset handler that clears all state and storage.

### Testing Strategy
- **Unit:** Test ConfirmDialog renders with correct props
- **Unit:** Test Cancel button calls onCancel
- **Unit:** Test Confirm button calls onConfirm
- **Unit:** Test ESC key triggers cancel
- **Integration:** Test reset clears localStorage
- **Integration:** Test reset restores default state
- **Edge Cases:** Test reset during policy, test reset with empty state

### Dependencies
Depends on M4-D4.1 (Automatic state persistence) - need localStorage to clear

### Verification
1. Add cards, click Reset → Confirmation dialog appears
2. Click Cancel → Dialog closes, cards still present
3. Click Reset (confirm) → Cards cleared, day=0, success toast
4. Check DevTools localStorage → `kanban-vibe-autosave` removed
5. Run `npm test` → All reset tests pass
